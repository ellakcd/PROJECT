{% extends 'base.html' %}
{% block title %}Homepage{% endblock %}
{% block content %}
<div id="fb-root"></div>
<script>
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=554256274953457&autoLogAppEvents=1';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));

  window.fbAsyncInit = function() {
    FB.init({
      appId      : '{554256274953457}',
      cookie     : true,
      xfbml      : true,
      version    : '{v2.8}'
    });
      
    FB.AppEvents.logPageView();   
    FB.api('/me', function(response) {
	console.log(JSON.stringify(response));
	});
  };

function showMe(){
	FB.api('/me', function(response) {
		$.post("/login", JSON.stringify(response), function(){
			console.log("logged in")
		});
	});
}

$("fb-login-button").on("click", showMe);

function showFriends() { 
	let friends = FB.api('/me/friends')
	console.log(friends);
}
  
</script>

	<h1>Welcome to Roommatch</h1> <br>

<div class="container-fluid">
        <fb:login-button scope="public_profile,email" onlogin="showMe();">
        </fb:login-button>
        <div id="status">
</div>


<div id="logout">
{% if session.get("current_user") %}
<form action="/logout">
<input type="submit" value="Log Out!"><br><br>
</form>
</div>

<a href="/users/{{ session["current_user"] }}"> View Your Profile </a><br>
<a href="/listings_by_friends_in_state"> View All Listings By Friends in Your State </a><br>
<a href="/user_friends_in_state"> View All Users with Mutual Friends in Your State </a><br><br><br>
<form action="/update_state" method="POST">
State: 
	<select name="state" required>
	{% for state in STATES %}
  		<option value="{{ state }}">{{ state }}</option>
	{% endfor %}
	</select><br>
<input type="submit" value="Update State">
</form>

<div id="housing-search">
Search for your new HOME:<br>
<form action="/house_search" method="GET">
What neighborhood do you want to live in?:<br>
	{% for neighborhood in neighborhoods %}
	<input type="checkbox" name="neighborhoods" value="{{ neighborhood }}"> {{ neighborhood }}
	{% endfor %}
Do you want (a) roommate(s)?:<br>
	<input type="radio" name="live_alone" value="no" checked> Heck Yes! <br>
	<input type="radio" name="live_alone" value="yes"> Nope <br>
	<input type="radio" name="live_alone" value="maybe"> I'm happy either way <br>
How long are you looking for?:<br>
	<input type="radio" name="duration" value="1" checked> About a month <br>
	<input type="radio" name="duration" value="2"> 2 months <br>
	<input type="radio" name="duration" value="3"> 3 months <br>
	<input type="radio" name="duration" value="4"> 4-6 months <br>
	<input type="radio" name="duration" value="5"> 6 months to a year <br>
	<input type="radio" name="duration" value="6"> More than a year <br>
What's the most you want to spend per month?:<br>
	<input type="number" name="price_cap" required><br>
What's your earliest start date?:<br>
	<input type="date" name="start_date" required><br>

	<input type="submit" value="Reveal Matches!">
</form>
<br>
</div>

<div id="roommate-search">
View some ROOMMATE options to move into your place: 
<form action="/roommate_search" method="GET">
<input type="submit" value="Find Roommates!">
</form>
</div>

{% else %}
<p>Log In!<br>
    <form action="/login" method="POST">
        Email: <input type="text" name="email" required><br>
        Password: <input type="text" name="password" required><br>
        <input type="submit" value="Welcome Home!">
    </form>

<a href="/listings_by_state"> View All Listings </a><br>
<a href="/users_by_state"> View All Users </a><br>

<h1><a href="/register">Create Your Profile!</a></h1>
	
{% endif %}

{% endblock %}